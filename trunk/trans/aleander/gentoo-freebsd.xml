<?xml version="1.0" encoding="UTF-8"?>
<!-- $Header: /var/www/www.gentoo.org/raw_cvs/gentoo/xml/htdocs/doc/en/gentoo-freebsd.xml,v 1.11 2005/12/06 12:32:46 jkt Exp $ -->
<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">

<guide link="/doc/en/gentoo-freebsd.xml">
<title>Krótkie wprowadzenie do Gentoo/FreeBSD</title>

<author title="Autor">
  <mail link="ignacio.arquelatour@gmail.com">Ignacio Arque-Latour</mail>
</author>
<author title="Autor">
  <mail link="citizen428@gentoo.org">Michael Kohl</mail>
</author>
<author title="Autor">
  <mail link="angusyoung@gentoo.org">Otavio R. Piske</mail>
</author>
<author title="Autor">
  <mail link="ka0ttic@gentoo.org">Aaron Walker</mail>
</author>
<author title="Tłumacz">
  <mail link="aleander@dark.freak.pl">Aleksander Kamil Modzelewski</mail>
</author>

<abstract>
Ten dokument przedstawia podstawowe informacje o FreeBSD oraz zapewnia
instrukcję instalacji Gentoo/FreeBSD. Zawiera także wskazówki dla osób
zainteresowanych pomocą w rozwoju projektu.
</abstract>

<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/2.5 -->
<license/>

<version>1.9</version>
<date>2005-12-06</date>

<chapter>
<title>Wprowadzenie do FreeBSD</title>
<section>
<title>Czym jest FreeBSD?</title>
<body>

<p>
<uri link="http://www.freebsd.org/">FreeBSD</uri> jest systemem
Unikso-podobnym opartym na wolnej <uri
link="http://www.freebsd.org/copyright/freebsd-license.html">licencji</uri>.
W roku 1993, gdy wstrzymano rozwój <uri
link="http://www.386bsd.org">386BSD</uri>, powstały dwa nowe projekty:
<uri link="http://www.netbsd.org/">NetBSD</uri>, powszechnie
rozpoznawany ze względu na ogromną ilość wspieranych architektur
sprzętowych, oraz FreeBSD, którego rozwój skupił się głównie na
platformie x86. FreeBSD jest szanowane za stabilność, wydajność oraz
bezpieczeństwo, dzięki czemu znalazło zastosowanie w zarówno małych, jak
i wielkich firmach na całym świecie. Aktualną stabilną wersją FreeBSD
jest 5.4 - na niej właśnie jest oparty projekt Gentoo/FreeBSD.
</p>

</body>
</section>
<section>
<title>Czym jest Gentoo/FreeBSD?</title>
<body>

<p>
Gentoo/FreeBSD ma na celu stworzenie w pełni funkcjonalnego systemu
FreeBSD przy zachowaniu założeń projektowych Gentoo. Długoterminowym
celem projektu jest zapewnienie użytkownikom możliwości wyboru dowolnej
kombinacji jąder Linuksa lub *BSD, libc w wersji GNU lub *BSD, oraz
narzędzi przestrzeni użytkownika w wersji *BSD lub GNU.
</p>

</body>
</section>
<section>
<title>FreeBSD a Linux</title>
<body>

<p>
Użytkownicy przenoszący się z Linuksa na FreeBSD z reguły uważają te
systemy za "prawie takie same". Faktycznie, jest pomiędzy nimi wiele
podobieństw. Istnieje jednak kilka kilka kluczowych różnic:
</p>

<ul>
  <li>
    W przeciwieństwie do Linuksa, który w zasadzie jest samym jądrem,
    FreeBSD jest kompletnym systemem operacyjnym, składającym się z
    biblioteki podstawowej C, narzędzi przestrzeni użytkownika i wielu
    innych elementów. To założenie konstrukcyjne czyni całość bardzo
    konsekwentną.
  </li>
  <li>
    W przeciwieństwie do jądra Linuksa, rozwój FreeBSD nie jest
    prowadzony przez jedną osobę, tylko przez niewielką grupę zwaną
    <uri
    link="http://www.freebsd.org/doc/en_US.ISO8859-1/articles/contributors/staff-core.html">Grupą Zarządzającą</uri>.
  </li>
</ul>

<p>
Ponadto istnieją też różnice techniczne oddzielające FreeBSD od Linuksa.
Niektóre z nich warto znać nawet, jeżeli nie zamierza się przyłączyć do
rozwoju Gentoo/FreeBSD:
</p>

<ul>
  <li>
    Funkcje dynamicznego łączenia, takie jak <c>dlopen()</c>, działają
    bez połączenia programu z biblioteką libdl (co jest wymagane na
    GNU/Linux). Zamiast tego po prostu łączy się je z libc.
  </li>
  <li>
    FreeBSD nie posiada oficjalnego narzędzia kompilacji jądra, więc
    zależności pomiędzy róznymi cechami muszą zostać rozstrzygnięte
    przez użytkownika.
  </li>
  <li>
    FreeBSD stosuje systemy plików UFS/UFS-2 i nie zawiera oficjalnego
    wsparcia dla ReiserFS ani XFS. Mimo to istnieją projekty dodania
    możliwości odczytu danych zapisanych przy ich użyciu. Dostęp do
    partycji ext2/ext3 jest już możliwy, jednak nie da się na nich
    zainstalować systemu.
  </li>
</ul>

</body>
</section>
</chapter>

<chapter>
<title>Instalacja Gentoo/FreeBSD</title>
<section>
<title>Instrukcja instalacji</title>
<body>

<p>
Po wprowadzeniu nadchodzi czas na zainstalowanie Gentoo/FreeBSD.
Niestety projekt nie dysponuje jeszcze własnym medium instalacyjnym,
więc konieczny jest wybór pomiędzy dwoma alternatywami. Pierwszą z nich
jest wykorzystanie istniejącej instalacji FreeBSD do podzielenia dysku
twardego na partycję i zainstalowania Gentoo/FreeBSD. Drugą z nich jest
użycie <uri link="http://www.freesbie.org">FreeSBIE LiveCD</uri>
jako medium instalacyjnego.
</p>

<p>
Zanim rozpoczniemy instalację należy przygotować dysk twardy do
wykorzystania z Gentoo/FreeBSD. Może to zostać dokonane albo przy użyciu
<c>sysinstall</c> (dostępne z istniejącej instalacji FreeBSD a także z
FreeSBIE) lub ręcznie, przy użyciu poleceń <c>fdisk</c>,
<c>disklabel</c> oraz <c>newfs</c>. Jeżeli jest to pierwsza próba
instalacji FreeBSD to <c>sysinstall</c> może okazać się najlepszym
wyborem. W razie problemów z podziałem lub formatowaniem dysków warto
zwrócić uwagę na świetny <uri
link="http://www.freebsd.org/doc/en_US.ISO8859-1/books/handbook/">Podręcznik
FreeBSD</uri> lub wejść na kanał <c>#gentoo-bsd</c> na serwerze IRC
Freenode.
</p>

<p>
Po zakończeniu konfiguracji dysków należy stworzyć punkt montowania dla
nowej instalacji Gentoo/FreeBSD oraz zamontować wszystkie niezbędne
partycje.
</p>

<pre caption="Tworzenie punktu montowania oraz montowanie partycji">
# <i>mkdir /mnt/gentoo</i>
<comment>(X należy zastąpić numerem właściwym dla odpowiedniego dysku.)</comment>
# <i>mount /dev/adXsXa /mnt/gentoo</i>
</pre>

<p>
Następnie należy ściągnąć i rozpakować archiwum zawierające obraz stage3.
</p>

<pre caption="Ściągnięcie oraz rozpakowanie archiwum stage3">
# <i>cd /mnt/gentoo/</i>
<comment>(Każdy inny mirror Gentoo zawierający katalog experimental/
również zadziała)</comment>
# <i>wget http://gentoo.osuosl.org/experimental/x86/freebsd/stages/stage3-x86-fbsd-20051020.tar.bz2</i>
# <i>tar -jxvpf stage3-x86-fbsd-20051020.tar.bz2</i>
<comment>(Za pomocą następnego polecenia można - ale nie trzeba - usunąć
archiwum stage3)</comment>
# <i>rm stage3-x86-fbsd-20051020.tar.bz2</i>
</pre>

<p>
Przez wykonaniem chroot do nowo rozpakowanego obrazu konieczne jest
jeszcze zainstalowanie aktualnej kopii nakładki Gentoo/FreeBSD.
Najprostszym sposobem jest ściągnięcie najnowszej jej migawki i 
rozpakowanie jej do <path>/mnt/gentoo/usr/local/portage</path>
</p>

<pre caption="Sprowadzanie nakładki Gentoo/FreeBSD na Portage">
# <i>cd /mnt/gentoo/usr/local/portage</i>
# <i>wget http://gentoo.osuosl.org/experimental/snapshots/portage-alt-overlay-latest.tar.bz2</i>
# <i>tar -xjf portage-alt-overlay-latest.tar.bz2</i>
<comment>(Można teraz usunąć migawkę)</comment>
# <i>rm portage-alt-overlay-latest.tar.bz2</i>
</pre>

<p>
Można również wykorzystać Subversion aby sprawdzić, jaka jest aktualna
wersja nakładki. W przypadku, gdy pożądane jest skorzystanie z tej
możliwości, należy zwrócić się do 
<uri link="/proj/en/gentoo-alt/overlay.xml">dokumentacji nakładki
Gentoo/ALT</uri>.
</p>

<p>
Przed chroot konieczne jest jeszcze zamontowanie katalogu
<path>/dev</path> z aktualnego systemu do odpowiedniego miejsca w
strukturze Gentoo/FreeBSD.
</p>

<pre caption="Montowanie /dev oraz zmiana korzenia drzewa katalogów">
# <i>mount -t devfs none /mnt/gentoo/dev/</i>
# <i>cp /etc/resolv.conf /mnt/gentoo/etc</i>
# <i>chroot /mnt/gentoo/ /bin/bash</i>
# <i>source /etc/profile</i>
</pre>

<p>
Po uzyskaniu nakładki Gentoo/FreeBSD nadhodzi czas na dowiązanie
<path>/etc/make.profile</path> do właściwego profilu i przygotowanie
<path>/etc/make.conf</path>.
</p>

<pre caption="Konfiguracja profilu oraz /etc/make.conf">
# <i>ln -sf /usr/local/portage/portage-alt-overlay/profiles/default-bsd/fbsd/5.4/x86/ /etc/make.profile</i>
<comment>(Standardowym edytorem we FreeBSD jest ee, którego użyjemy do
edycji /etc/make.conf</comment>
# <i>ee /etc/make.conf</i>
<comment>(Należy upewnić się, że dodano co najmniej następujące 
wpisy:)</comment>
CHOST="i686-gentoo-freebsd5.4"
ACCEPT_KEYWORDS="~x86-fbsd ~x86"
FEATURES="-sandbox collision-protect"
PORTDIR_OVERLAY="/usr/local/portage/portage-alt-overlay"
</pre>

<p>
Aby start systemu mógł przebiegać poprawnie konieczne jest też
stworzenie katalogu <path>/proc</path>.
</p>

<pre caption="Tworzenie katalogu /proc">
# <i>mkdir /proc</i>
</pre>

<p>
Teraz ściągniemy kopię głównego drzewa Portage, co na słabszych łączach
może zająć całkiem sporo czasu.
</p>

<pre caption="Pozyskiwanie drzewa Portage">
# <i>emerge --sync</i>
<comment>(Możliwe jest również uzyskanie drzewa Portage w inny sposób:)</comment>
# <i>cd /</i>
# <i>wget http://gentoo.osuosl.org/snapshots/portage-latest.tar.bz2</i>
# <i>tar -xjf portage-latest.tar.bz2 -C /usr/</i>
# <i>emerge --metadata</i>
</pre>

<p>
W razie potrzeby można również przebudować podstawowe pakiety systemowe:
</p>

<pre caption="Opcjonalne przebudowanie podstawowych pakietów FreeBSD">
# <i>emerge -e system</i>
</pre>

<p>
Po wykonaniu <c>emerge -e system</c>, źródła jądra FreeBSD zostały
zainstalowane do <path>/usr/src/sys</path>. Jeżeli krok ten został
pominięty, można je pozyskać w następujący sposób:
</p>

<pre caption="Pozyskiwanie źródeł jądra FreeBSD">
# <i>emerge freebsd-sources</i>
</pre>

<p>
Konfiguracja i kompilacja własnego jądra jest bardzo odmienna od swojego
linuksowego odpowiednika, więc w razie wątpliwości należy skonsultować
się z 
<uri link="http://www.freebsd.org/doc/en_US.ISO8859-1/books/handbook/kernelconfig.html">
rozdziałem ósmym</uri> podręcznika FreeBSD.
</p>

<p>
Należy również zwrócić uwagę na to, że jedynie "Tradycyjny" sposób
kompilacji jest akutalnie wspierany przez Gentoo/FreeBSD. Dodatkowo
<c>make install</c> prawdpodobnie zapyta o plik
<path>/boot/device.hints</path>. Domyślna jego wersja może zostać
znaleziona w podkatalogu <path>conf</path> konfiguracji <c>GENERIC</c> i
nazwana jest <path>GENERIC.hints</path>.
</p>

<p>
Teraz można już dokonać podstawowej konfiguracji systemu. Najpierw
zdefiniujemy punkty montowania w <path>/etc/fstab</path>:
</p>

<pre caption="Edycja /etc/fstab">
# <i>ee /etc/fstab</i>
<comment>(To jest tylko przykład - X oraz Y należy zastąpić licbami
właściwymi dla danej konfiguracji.)</comment>
#Device         Mountpoint      Fstype          Options         Dump    Pass
/dev/adXsYb     none            swap            sw              0       0
/dev/adXsYa     /               ufs             rw              1       1
/dev/adXsYe     /usr/home       ufs             rw              2       2
/dev/adXsYd     /tmp            ufs             rw              2       2
/dev/acdX       /cdrom          cd9660          ro,noauto       0       0
</pre>

<p>
Teraz jest też właściwy czas aby skonfigurować połączenia sieciowe przed
ostatecznym przeładowaniem systemu:
</p>

<pre caption="Konfiguracja sieci">
# <i>ee /etc/conf.d/net</i>
<comment>(To również jest tylko przykład, który trzeba zmodyfikować na
potrzeby konkretnej sieci.)</comment>
ifconfig_rl0=("192.168.0.10 netmask 255.255.255.0 broadcast 192.168.0.255")
routes_rl0=("-net 0.0.0.0 -host 192.168.0.1")
</pre>

<p>
Aby zmienić nazwę komputera należy zmodyfikować <path>/etc/hostname</path>.
</p>

<pre caption="Zmiana nazwy komputera">
# <i>echo "NAZWA_KOMPUTERA" > /etc/hostname</i>
</pre>

<p>
W przypadku, gdy użytkownicy maszyny będą wykorzystywać układów
klawiatury innych niż standardowy, należy ustawić właściwą wartość w
<path>/etc/conf.d/syscons</path>. Następujący przykład pokazuje
konfigurację dla układu hiszpańskiego, należy więc go zmodyfikować w
celu dostosowania do konkretnej instalacji.
</p>

<pre caption="Zmiana układu klawiatury (opcjonalnie)">
# <i>ee /etc/conf.d/syscons</i>
KEYMAP="spanish.iso.acc"
<comment>(Dostępne układy można znaleźć w katalogu /usr/share/syscons/keymaps).</comment>
</pre>

<impo>
Absolutnie koniecznym jest przygotowanie bootloadera na Gentoo/FreeBSD,
w przeciwnym wypadku niemożliwe będzie wystartowanie nowo
zainstalowanego systemu! Jeżeli na komputerze nie ma innego bootloadera,
należy zastosować <c>boot0</c>, ponieważ jest on jedynym aktualnie
wspieranym przez FreeBSD. W takim wypadku należy dodać pozostałe obecne
na komputerze systemy operacyjne do konfiguracji <c>boot0</c>.
</impo>

<pre caption="Instalacja i konfiguracja boot0">
# <i>emerge boot0</i>
<comment>(Opuszczenie środowiska chroot)</comment>
# <i>exit</i>
<comment>(Dalsze polecenia muszą zostać wydane spoza chroot)</comment>
# <i>fdisk -b -B /mnt/gentoo/boot/boot0 /dev/adX</i>
# <i>chroot /mnt/gentoo /bin/bash</i>
# <i>disklabel -B adXsY</i>
</pre>

<p>
Dalsze informacje dotyczące konfiguracji <c>boot0</c> dostępne są w
<uri link="http://www.freebsd.org/doc/en_US.ISO8859-1/books/handbook/boot.html">
rozdziale dwunastym</uri> podręcznika FreeBSD.
</p>

<p>
Należy też zmienić hasło użytkownika <c>root</c> oraz dodać konto
zwykłego użytkownika przeznaczone do codziennej pracy.
</p>

<pre caption="Zmiana hasła użytkownika root oraz dodawanie nowego
użytkownika">
# <i>passwd</i>
<comment>(Dalsze informacje dostępne są w podręczniku FreeBSD).</comment>
# <i>adduser</i>
</pre>

<p>
Gratulacje, instalacja Gentoo/FreeBSD jest już gotowa i można rozpocząć
odkrywanie jej możliwości zaraz po restarcie systemu. Powodzenia!
</p>

<pre caption="Restart systemu">
# <i>exit</i>
# <i>reboot</i>
</pre>

</body>
</section>
</chapter>

<chapter>
<title>Rozwijanie Gentoo/FreeBSD</title>
<section>
<title>Jak pomóc</title>
<body>

<p>
Pomoc jest potrzebna w wielu dziedzinach, zależnie od ilości dostępnego
czasu oraz poziomu umiejętności:
</p>

<ul>
  <li>
    Potrzebni są hakerzy GCC oraz binutils którzy mogliby przenieść
    rozmaite łatki specyficzne dla FreeBSD do głównego drzewa Portage.
  </li>
  <li>
    Praca nad aktualnymi ebuildami: oznacza to ścisłą współpracę z
    osobami odpowiedzialnymi za ebuildy w celu przygotowania łatek oraz
    modyfikacji ebuildów tak, aby zostały one zaakceptowane w głównym
    drzewie.
  </li>
  <li>
    Bezpieczeństwo: osoby zainteresowane zabezpieczeniami są bardzo
    potrzebne! Wprawdzie doniesienia o zagrożeniach od projektu FreeBSD
    są śledzone i uwzględniane, dodatkowa pomoc jest zawsze potrzebna.
  </li>
  <li>
    Kontakty: potrzebni są nam ludzie dysponujący znajomościami wśród
    deweloperów FreeBSD w celu utrzymywania kontaktu między nami a
    oryginalnym projektem dla wymiany łatek oraz dyskusji rozmaitych
    problemów i ich rozwiązań. Uwaga: taka działalność nigdy nie powinna
    żadnej formy spamowania na listach dyskusyjnych ani kanałach IRC.
  </li>
  <li>
    Testowanie: im więcej ludzi wykorzystuje Gentoo/FreeBSD tym więcej
    błędów będzie rozpoznawanych, co pomaga nam w poprawianiu jakości
    produktu. Osoby potrafiące umiejętnie opisać błędy oraz problemy
    będą bardzo przydatne.
  </li>
  <li>
    Inne dziedziny również wymagają wsparcia, w tym: ebuidly systemowe,
    baselayout, tworzenie płyt instalacyjnych, dokumentacja, modyfikacje
    jądra.
  </li>
</ul>

</body>
</section>
<section>
<title>Budowa systemu oraz poprawianie problemów</title>
<body>

<p>
Although Linux and FreeBSD both are Unix-like operating systems, there are some
important differences you have to know about if you want to contribute to our
development effort:
</p>

<ul>
  <li>
    FreeBSD doesn't use the GNU autotools (autoconf, automake, autoheader).
    Instead, it uses its own implementation of <c>make</c>, putting
    configuration options in external files and some .mk files that are
    included with each Makefile. Although a lot of work has been put into
    those .mk files, it is not hard to find some installations failing due to
    a missing <c>${INSTALL}&nbsp;-d</c> somewhere. The easy way to deal with
    this kind of problem is to read the Makefile to find the accompanying .mk
    file, then open that file and try to figure out which part failed (this is
    not really hard once you figure out where in the installation process it
    stopped).
  </li>
  <li>
    Besides, due to the fact that FreeBSD is a complete operating system, you
    won't find things like a FreeBSD kernel tarball for download on a web site.
    The system is meant to be concise, thus whenever you start making an ebuild
    for something that uses system sources, you are very likely to run into
    problems when it tries to access non-existent files or directories. This
    generally occurs when a Makefile points to <path>${.CURDIR}/../sys</path>,
    or when a Makefile has a source dependency on another system package. There
    is no default rule on dealing with such issues, but generally one of the
    following procedures helps:
    <ul>
      <li>
        If the ebuild is trying to access kernel sources, patch it to point to
        <path>/usr/src/sys</path>
      </li>
      <li>
        If it's trying to access some other source that is provided by the
        system, it's easier to add it to <c>$SRC_URI</c> and unpack it to
        <c>$WORKDIR</c>
      </li>
    </ul>
  </li>
  <li>
    In order to maintain a concise buildsystem, we have several tarballs which
    are grouped by their functionality. This means that system libraries can be
    found in the freebsd-lib tarball, which contains the sources you would
    usually find in /usr/src/lib. On the other hand, freebsd-usrsbin contains
    <path>/usr/sbin/*</path> tools and consists of sources from
    <path>/usr/src/usr.sbin</path>.
  </li>
</ul>

</body>
</section>
<section>
<title>Known issues</title>
<body>

<p>
At the moment, there are still quite a lot of known issues. Here are the ones
really worth noting:
</p>

<ul>
  <li>
    Some init scripts depend on the clock service which we don't provide right
    now. You can just remove it from the dependencies of the script and report
    that on our <uri link="http://bugs.gentoo.org/">bugzilla</uri>. Please
    remember to use the "Gentoo BSD" product for your submission.
  </li>
  <li>glib and gnome in general need a lot of fixes to be backported.</li>
</ul>

</body>
</section>
</chapter>

<chapter>
<title>Contact</title>
<section>
<body>

<p>
A list of Gentoo/FreeBSD developers can be found at the <uri
link="/proj/en/gentoo-alt/bsd/fbsd/">project page</uri>. Other ways to contact
Gentoo/FreeBSD developers include our IRC Channel <c>#gentoo-bsd</c> on
Freenode, as well as the <uri link="/main/en/lists.xml">gentoo-bsd mailing
list</uri>.
</p>

</body>
</section>
</chapter>
</guide>
