<?xml version='1.0' encoding='UTF-8'?>
<!-- $Header:
/var/www/www.gentoo.org/raw_cvs/gentoo/xml/htdocs/proj/pl/base/amd64/Attic/install-software.xml,v
1.19 2005/08/24 11:42:41 blubb dead $ -->
<!DOCTYPE sections SYSTEM "/dtd/book.dtd">

<!-- The context of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommonds.org/licenses/by-sa/1.0 -->

<sections>

<section>
	<title>Dostępne jądra</title>
<subsection>
	<title>Na LiveCD</title>
<body>
<p>
Od czasu wydania Gentoo 2004.3, na LiveCD dostępne jest jedno jądro, którego
można użyć do bootowania. Jest to jądro typu SMP i nazywa się <c>gentoo</c>.
Komputery innego typu wciąż mogą z tego kernela korzystać.
</p>
</body>
</subsection>
<subsection>
	<title>Użycie prawidłowych źródeł jądra</title>
<body>
<impo>Należy korzystać z jąder linii <path>sys-kernel/gentoo-dev-sources</path>!
Zawierają one łatki specyficzne dla AMD64 oraz inne dodatkowe rozszerzenia.
Wykorzystanie innych kerneli nie jest wspierane.</impo>
</body>
</subsection>
<subsection>
	<title>Budowanie jądra dla laptopa eMachine</title>
<body>
<p>
Przed wydaniem Gentoo 2004.3, w czasie konfiguracji jądra dla laptopa eMachine
Mobile Athlon64 <e>konieczne</e> było wkompilowanie wsparcia dla USB. W
przeciwnym razie generowany był błąd "unknown keypress" z pliku
<path>atkbd.c</path>. Wyłączenie wparcia dla USB nie działało.
</p>
<p>
Wszelkie problemu związane z pracą Gentoo 2004.3 na laptopach eMachine powinny
być raportowane poprzez stronę bugs.gentoo.org.
</p>
</body>
</subsection>
 <subsection>
	<title>Jądra 2.4.x oficjalnie zdeprecjonowane</title>
<body>
<p>
<b>Linia jąder 2.4.x została oficjalnie zdeprecjonowana dla komputerów
AMD64.</b> Gdy w jądrach wersji 2.4.23-pre7 zrezygnowano ze wsparcia dla devfs
(zostało ono ukryte), pojawił się problem z zarządzaniem pamięcią, co było
powodem dokonania deprecjacji. W Gentoo nie doświadczyliśmy tego typu problemów,
jednak kernele linii 2.4 nie są dobrym rozwiązaniem ze względu na brak wsparcia
dla devfs.
</p>
</body>
</subsection>
<subsection>
	<title>gcc 3.3 oficjalnie zdeprecjonowane</title>
<body>
<p>
<b>Od chwili wydania Gentoo 2004.3, gcc 3.3 zostało oficjalnie zdeprecjonowane
dla komputerów AMD64.</b> Wszystkie wydania od 2004.3 opierają się na gcc 3.4.x.
</p>
</body>
</subsection>
</section>
<section><title>Błędy w czasie uruchamiania systemu zgłaszane przez jądro</title>
<body>
<p>
Jeśli w czasie uruchamiania systemu jądro zgłasza błędy (następuje kernel
panic), zaleca się przekazanie parametru <c>idle=poll</c> jako opcji bootowania.
Istnieje problem związany z wieloma BIOS-ami i wydaje się on dotykać głównie
płyt głównych z chipsetem VIA. Dodanie powyższego parametru do opcji
uruchamiania jądra może nastąpić jedynie <e>po</e> aktualizaji do najnowszej
wersji BIOS-u, jaką udostępnia producent posiadanej płyty głównej. Być może uda
się rozwiązać ten problem poprzez wyłączenie opcji "Legacy USB support" w
BIOS-ie. Jeśli jednak jesteśmy zmuszeni to użycia parametru <c>idle-poll</c>,
powinniśmy skontaktować się z producentem płyty głównej lub dostawcą BIOS-u, aby
uzyskać informacje o rozwiązaniu problemu #93 z erraty CPU.
</p>
<p>
Aby uzystać więcej informacji na ten temat, warto odwiedzić te archiwa list
mailingowych:
</p>
<ul>
	<li><uri>http://lists.suse.com/archive/suse-amd64/2003-Dec/0031.html</uri></li>
	<li><uri>http://lists.suse.com/archive/suse-amd64/2003-Dec/0034.html</uri></li>
</ul>
<p>
Widać na ich podstawie, że nie jest to problem specyficzny dla Gentoo.
</p>
</body>
</section>

<section><title>Wsparcie systemów plików</title>
<body>
<p>
Mocno rekomendowane jest korzystanie z systemów plików ext2/ext3. Pojawiały się
raporty o problemach z systemem plików reiserfs na komputerach AMD64, a także
pojawiają się informacje o problemach z JFS na 64-bitowych systemach (co
zdecydowanie należy określić jako dziwne, ponieważ ten system plików został
zaprojektowany z myślą o komputerach 64-bitowych).
</p>
<table>
<tr>
 	<th>System plików:</th>
	<th>Status:</th>
</tr>
<tr>
	<ti>ext2</ti>
	<ti>STABILNY</ti>
</tr>
<tr>
	<ti>ext3</ti>
	<ti>STABILNY</ti>
</tr>
<tr>
	<ti>XFS</ti>
	<ti>STABILNY, >=gentoo-dev-sources-2.6.3</ti>
</tr>
<tr>
	<ti>JFS</ti>
	<ti>STABILNY, >=gentoo-dev-sources-2.6.7</ti>
</tr>
<tr>
	<ti>reiserfs</ti>
	<ti>STABILNY, >=gentoo-dev-sources-2.6.5</ti>
</tr>
<tr>
	<ti>reiser4</ti>
	<ti>NIE DZIAŁA NA AMD64, NIE JEST WSPIERANY NA ŻADNEJ ARCHITEKTURZE!</ti>
</tr>
</table>
<p>
Prosimy o zgłaszanie wszelkich problemów z systemami plików na stronie bugs.gentoo.org.
</p>
</body>
</section>
 
<section><title>Bootloader: kompilowanie programu grub</title>
<body>
<p>
Instalacja programu grub nie jest możliwa w czystym 64-bitowym środowisku. Można
go skompilować jedynie przy użyciu gcc ze wsparciem dla multilib. Gentoo 2004.3
domyślnie dołącza wsparcie dla multilib. Jeśli zdecydujemy się na usunięcie z
gcc wsparcia dla tego komponentu, konieczne będzie użycie programu
<c>grub-static</c> zamiast gruba. <c>grub-static</c> instalujemy przy użyciu
komend:
</p>
<pre caption="Instalacja grub-static">
emerge grub-static
cp -Rpv /usr/share/grub/i386-pc/* /boot/grub
</pre>
</body>
</section>
 
<section><title>Dłuższe maskowanie niektórych pakietów</title>
<body>
<p>
Pewne pakiety, które zostały odmaskowane dla innych architektur, są wciąż
zamaskowane dla AMD64. Nie oznacza to oczywiście, że pakiety te nie działają.
Oznacza to jedynie, że żaden z developerów Gentoo nie mógł przetestować ich na
komputerze AMD64. Prosimy w związku z tym o testowanie zamaskowanych aplikacji i 
<uri link="http://bugs.gentoo.org">zgłaszanie raportów o błędach</uri>, aby
poinformować developorów czy pakiety działają poprawnie, czy też nie.
</p>
</body>
</section>

<section><title>Niedziałające pakiety</title>
<body>
<p>
Aktualnie niedziałające pakiety: 
</p>
<ul>
	<li>Firebird (baza danych, a NIE przeglądarka)</li>
</ul>
<p>
Pakiety, które nie działają z trybie 64-bitowym, ale działają w trybie 32-bitowym
(po instalacji app-emulation/emul-linux-x86-baselibs i pokrewnych):
</p>
<ul>
	<li>Wszystkie programy, które korzystają z 32-bitowych plików dll z
	Windows (jak na przykład wsparcie mplayer/xine dla własnych formatów);</li>
	<li>Wszystkie programy, które wymagają 32-bitowego wsparcia.</li>
</ul>
</body>
</section>

<section><title>Wsparcie dla Javy</title>
<body>
<p>
Blackdown wypuścił własną 64-bitową werjsę Javy dla Linuksa na komputerach
AMD64. Jest to warunkowo opublikowana edycja, więc nie należy oczekiwać, że
będzie ona doskonale działać. W drzewie portage występuje ona jako
<path>blackdown-jdk-1.4.2</path> i <path>blackdown-jre-1.4.2</path>.
</p>
<p>
Niektórzy użytkownicy zauważyli, że 64-bitowa Java VM jest wolniejsza od jej
32-bitowego odpowiednika. Juergen Kreileder z Blackdown udzielił następujących
informacji na ten temat:
</p>
<pre caption="Juergen Kreileder o różnicach w prędkości działania Javy w
wersjach 64- i 32-bitowych">
Obecnie 64-bitowa Java VM jest szysza od 32-bitowego odpowiednika w niemal
wszystkich testach.

Różnica zauważana przez użytkowników jest raczej efektem użycia różnych typów
Javy VM. Wersja dla i386 obejmuje Javę HotSpot Client VM i HotSpot
Server VM, przy czym domyślnie zostaje wykorzystany typ Client VM. Wersja dla
AMD64 zawiera wyłącznie typ Server VM, gdyż Client VM nie został jeszcze
przygotowany.

Ogólnie rzecz biorąc Server VM jest szybszym typem. Jego kompilator
wykonuje bardziej szczegółową optymalizację i jest bardziej agresywny niż
kompilator typu Client VM. Dzięki temu zazwyczaj generuje on znacznie lepszy
kod. Wadą jest natomist to, że tak szczegółowa optymalizacja obciąża procesor w
większym stopniu. W związku z tym kod GUI jest w Client VM zazwyczaj
przetwarzany szybciej (przynajmniej początkowo) niż na Server VM.

Innymi słowy: porównywanie tupy Client VM dla i386 z typem Server VM dla AMD64
nie jest wymierne. Należałoby raczej porównać Server VM dla i386 (np.: "java
-server ...") z Server VM dla AMD64.
</pre>
<p>
Juergen Kreileder odpowiedział również na pytanie o potencjalny czas ukończenie
Javy Client VM dla AMD64:
</p>
<pre caption="Juergen Kreileder o Java Client VM dla AMD64">
Nie znajdzie się on w finalnej wersji 1.4.2. Nie jest on również przewidywany
dla wersji 1.5.0 (zarówno firma Sun, jak i Blackdown nie są nim zainteresowane).
Firma Sun jest zadowolona z Javy Server VM i tak na prawdę nie jest
zainteresowana wdrożeniem Javy Client VM (na innych 64-bitowych maszynach, jak
IA64 &amp; SPARC64, również dostępna jest tylko Java Server VM). Wprowadzenie
wersji Client VM zajełoby zbyt dużo czasu, aby robić to bez zapłaty.
</pre>
<p>
Tak więc, aby wyniki porównania były wymierne, konieczne jest przetestowanie na
obu architekturach wersji Server, a wersji Client dla AMD64 nie należy się
spodziewać zbyt szybko. ;-)
</p>
<p>
Gdy java zostanie zainstalowana, wymagane jest stworzenie następującego
dowiązania symbolicznego, aby pracowała ona z mozillą (i prawdopodobnie z
konqueorem):
</p>
<pre caption="Dowiązanie symboliczne dla współpracy javy z mozillą">
/usr/lib/nsbrowser/plugins/libjavaplugin_oji.so -> /opt/blackdown-jdk-1.4.2_rc1/jre/plugin/amd64/mozilla/libjavaplugin_oji.so
</pre>
</body>
</section>
 
<section><title>Instalacja programu OpenOffice</title>
<body>
<p>
OpenOffice jest obecnie dostępny jedynie w 32-bitowej binarnej formie, gdyż
wersje 1.1.x nie mogą zostać skompilowane na komputerach AMD64. Aby zainstalować
OpenOfficea należy zemergować pakiet <path>app-office/openoffice-bin</path>.
</p>
<note>Nie warto nawet zastanawiać się nad instalacją OpenOfficea ze źródeł. Będą
to daremne wysiłki, które zaowocują jedynie wieloma nieprzespanymi nocami.</note>
</body>
</section>

<section><title>Prawidłowe ustawienie CFLAGS</title>
<body>
<p>
W przeciwieństwie do gcc 3.3, gcc 3.4 wymaga ustawienia parametru -march.
Najbardziej konserwatywnymi (i najlepiej wspieranymi) ustawieniami CFLAGS są:
</p>
<pre caption="gcc-3.4 CFLAGS">
...
CFLAGS="-march=k8 -O2 -pipe"
...
</pre>
<note>
<c>-march=k8</c> oznacza to samo co <c>-march=athlon64</c> oraz <c>-march=opteron</c>.
</note>
<p>
There used to be issues with the lack of <c>-fPIC</c> being specified when
building shared objects, the reasoning is in this mailing list post: 
 <uri link="http://www.x86-64.org/lists/discuss/msg02621.html">Porting to
Hammer</uri> -- scan down to "Shared libraries must be compiled with -fPIC". If
you find any packages that complain about needing <c>-fPIC</c> to run/link
properly, please notify us immediately, as we need to update that package.
Please do not specify <c>-fPIC</c> in your global CFLAGS as that is not an
acceptable solution and just a workaround.
</p>
<p>
Please do not add <c>-m32</c> to your USE flags, as you do not want to compile
the system in 32-bit mode, and by default Gentoo does not support compiling
32-bit binaries. Use of the <c>-m64</c> flag is irrelevant as the compiler
defaults to 64-bit mode and could have negative effects on code that may supply
<c>-m32</c> internally to compile 32-bit assembly (such as newer releases of
grub will do).
</p>
<warn>Don't use <c>-Os</c>. This has been known to prevent parts of KDE 3.2.0 from compiling.</warn>
</body>
</section>
 
<section><title>USE Flags That Are Ignored</title>
<body>
<p>
The <c>mmx</c>, <c>3dnow</c>, <c>sse</c> and <c>sse2</c> USE flags are ignored
on AMD64, since all AMD64 processors support those instruction sets. The are
ignored because they enable 32bit assembly optimisation for some packages.
</p>
</body>
</section>
 
<section><title>Reporting Bugs And Submitting Patches</title>
<body>
<p>
If you an application that you've had problems with, have a patch to solve
problems, or want to report a successful build so we can mark it as such in
portage, please post a bug report on <uri
link="http://bugs.gentoo.org">bugs.gentoo.org</uri>.
</p>
<note>You may also CC: <mail link="amd64@gentoo.org">amd64@gentoo.org</mail> if you wish.</note>
<note>To submit a patch, you must first submit a bug report, then go back to
the bug report and select "Create a new attachment".</note>
</body>
</section>

</sections>
